---
title: "hamnetfinder"
output: html_notebook
---

I was thinking it would be interested to try and develop a shiny app that
scrapes and presents ham nets with their times and frequencies and other 
information.

```{r get_spreadsheet}
library(readxl)
library(httr)

get_todays_ham_nets <- function(zone) {
  thisDay <- Sys.Date()
  data_file <- paste0(zone,"_ham_nets_",thisDay,".Rda")
  if ( !file.exists(data_file) ) {
    xlsx_url <- paste0('https://www.theweatherwonder.com/Net_List_Spreadsheet_',zone,'_Time.xlsx')
    GET(xlsx_url, write_disk(tf <- tempfile(fileext = ".xlsx")))
    test <- read_excel(tf, sheet = 1)
    col_type_vec <- c("text", rep("guess", times=7), "date", "skip", rep("text", times=3),"skip")
    xlsx <- read_excel(tf, sheet=1, col_types=col_type_vec[1:ncol(test)], skip =1)
    xlsx[,2:8] <- !is.na(xlsx[,2:8])
    xlsx[[zone]] <- format(xlsx[[zone]], format='%-I:%M %p')
    save(xlsx, file=data_file)
  }
}


zones <- c("Eastern","Mountain","Central","Pacific")
get_todays_ham_nets(zones[4])

```


